  {% extends "base.html" %}
  {% load static %}

  {% block extra_css %}
  <link rel="stylesheet" href="{% static 'products/css/products.css' %}">
  {% endblock %}


  {% block content %}

  <div class="row no-gutters">
    <div class="col-1 offset-1">
      <div class="row no-gutters">
        <div class="col-12">
          <button class="filter-dropdown-button" type="button" data-toggle="collapse" data-target="#price-range-menu"
            aria-haspopup="true" aria-expanded="false">
            Price
          </button>
          <div class="filter collapse show" id="price-range-menu">
            <div class="row no-gutters">
              <div class="col-6">
                <div class="mr-1">
                  <input class="form-control" type="number" name="" id="lower-price">
                </div>
              </div>
              <div class="col-6">
                <div class="ml-1">
                  <input class="form-control" type="number" name="" id="upper-price">
                </div>
              </div>
              <div class="col-12" id="slider"></div>
            </div>
          </div>
        </div>
        <div class="col-12 dark-hr"></div>
        <div class="col-12">
          <button class="filter-dropdown-button" type="button" data-toggle="collapse" data-target="#genre-dropdown-menu"
            aria-haspopup="true" aria-expanded="false">
            Genres
          </button>
          <div class="filter collapse show" id="genre-dropdown-menu">
            {% for genre in genres  %}
            <div class="filter-checkbox">
              <input type="checkbox" id="{{genre.friendly_name}}" name="{{genre.friendly_name}}"
                value="{{genre.friendly_name}}">
              <label for="{{genre.friendly_name}}">{{genre.friendly_name}}</label><br>
            </div>
            {% endfor %}
          </div>
        </div>
        <div class="col-12 dark-hr"></div>
        <div class="col-12">
          <button class="filter-dropdown-button" type="button" data-toggle="collapse"
            data-target="#artist-dropdown-menu" aria-haspopup="true" aria-expanded="false">
            Artist
          </button>
          <div class="filter collapse show" id="artist-dropdown-menu">
            {% for artist in artists  %}
            <div class="filter-checkbox">
              <input type="checkbox" id="{{artist.friendly_name}}" name="{{artist.friendly_name}}"
                value="{{artist.friendly_name}}">
              <label for="{{artist.friendly_name}}">{{artist.friendly_name}}</label><br>
            </div>
            {% endfor %}
          </div>
        </div>
        <div class="col-12 dark-hr"></div>
        <div class="col-12">
          <button class="filter-dropdown-button" type="button" data-toggle="collapse" data-target="#label-dropdown-menu"
            aria-haspopup="true" aria-expanded="false">
            Label
          </button>
          <div class="filter collapse show" id="label-dropdown-menu">
            {% for label in labels  %}
            <div class="filter-checkbox">
              <input type="checkbox" id="{{label.friendly_name}}" name="{{label.friendly_name}}"
                value="{{label.friendly_name}}">
              <label for="{{label.friendly_name}}">{{label.friendly_name}}</label><br>
            </div>
            {% endfor %}
          </div>
        </div>
        <div class="col-12 dark-hr"></div>
        <div class="col-12">
          <button class="filter-dropdown-button" type="button" data-toggle="collapse"
            data-target="#format-dropdown-menu" aria-haspopup="true" aria-expanded="false">
            Format
          </button>
          <div class="filter collapse show" id="format-dropdown-menu">
            {% for format in formats  %}
            <div class="filter-checkbox">
              <input type="checkbox" id="{{format.friendly_name}}" name="{{format.friendly_name}}"
                value="{{format.friendly_name}}">
              <label for="{{format.friendly_name}}">{{format.friendly_name}}</label><br>
            </div>
            {% endfor %}
          </div>
        </div>
        <div class="col-12 dark-hr"></div>
        <div class="col-12">
          <button class="filter-dropdown-button" type="button" data-toggle="collapse"
            data-target="#colour-dropdown-menu" aria-haspopup="true" aria-expanded="false">
            Colour
          </button>
          <div class="filter collapse show" id="colour-dropdown-menu">
            {% for colour in colours  %}
            <div class="filter-checkbox">
              <input type="checkbox" id="{{colour.friendly_name}}" name="{{colour.friendly_name}}"
                value="{{colour.friendly_name}}">
              <label for="{{colour.friendly_name}}">{{colour.friendly_name}}</label><br>
            </div>
            {% endfor %}
          </div>
        </div>
        <div class="col-12 dark-hr"></div>
        <div class="col-12">
          <button class="filter-dropdown-button" type="button" data-toggle="collapse" data-target="#tag-dropdown-menu"
            aria-haspopup="true" aria-expanded="false">
            Tag
          </button>
          <div class="filter collapse show" id="tag-dropdown-menu">
            {% for tag in tags  %}
            <div class="filter-checkbox">
              <input type="checkbox" id="{{tag.friendly_name}}" name="{{tag.friendly_name}}"
                value="{{tag.friendly_name}}">
              <tag for="{{tag.friendly_name}}">{{tag.friendly_name}}</tag><br>
            </div>
            {% endfor %}
          </div>
        </div>
        <div class="col-12 dark-hr"></div>
      </div>
    </div>
    <div class="col-lg-8">
      <div class="row no-gutters">
        {% for product in products %}
        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-4 product-card">
          <div class="square">
            <div class="square-inner text-center">
              <div class="h-75 product-header">
                {% if product.image %}
                <div class="product-image" style="background-image: url({{product.image.url}})"></div>
                {% else %}

                {% endif %}
                <form class="form" action="{% url 'add_to_cart' product.id %}" method="POST">
                  {% csrf_token %}
                  <input class="add-to-cart-hover-button text-center dark-button" type="submit"
                    value="Add to cart"></input>
                  <input class="form-control qty_input" type="hidden" name="quantity" value="1" min="1" max="99"
                    data-item_id="{{ product.id }}" id="id_qty_{{ product.id }}" />
                  <input type="hidden" name="redirect_url" value="{{ request.path }}" />
                </form>

              </div>
              <a href="{% url 'view_product' product.id %}">{{product.name}}</a>
              <h2>{{product.label.friendly_name}}</h2>
              <h2>{{product.price}}</h2>
            </div>
          </div>
        </div>
        {% endfor %}
      </div>
    </div>
  </div>



  {% endblock %}

  {% block postloadjs %}
  {{ block.super }}
  <script src="https://cdnjs.cloudflare.com/ajax/libs/noUiSlider/14.6.3/nouislider.min.js"
    integrity="sha512-EnXkkBUGl2gBm/EIZEgwWpQNavsnBbeMtjklwAa7jLj60mJk932aqzXFmdPKCG6ge/i8iOCK0Uwl1Qp+S0zowg=="
    crossorigin="anonymous"></script>
  <script>
    var slider = document.getElementById('slider');

    noUiSlider.create(slider, {
      start: [0, 300],
      connect: true,
      range: {
        'min': 0,
        'max': 300
      }
    });

    var lowerPrice = document.getElementById('lower-price');
    var upperPrice = document.getElementById('upper-price');
    slider.noUiSlider.on('update', function (values, handle) {
      lowerPrice.value = values[0];
      upperPrice.value = values[1];
    });
  </script>
  {% endblock %}